---
layout:     post
title:      "也谈正则表达式"
subtitle:   "正则表达式 in JavaScript"
date:       2017-02-17 00:00
author:     "LanceLou"
header-img: "img/post-about-regexp.png"
catalog: true
tags:
    - JavaScript
---

> 今天，Lance就谈谈开发中较为常见的正则表达式在JavaScript中的运用，做个总结。对于我所知道正则表达式的一些运用，也做下列举，如有不足，欢迎各位补充。

## 前言

其实在JavaScript中，正则表达式包含的知识不多，但其在实际的使用过程中，却是非常灵活的。对于一些JavaScript中正则表达式的基础知识，我将在文末进行列出，先来谈谈我认为的正则。


## So Called RegExp

#### 正则分组(字符提取)

关于正则表达式的分组，这里我们引入正则中的括号，在正则中，括号可以把单独的项组合成子表达式，以便可以像处理一个单独的单元那样用"\|", "*", "+", 或者 "?" 等来对单元内的项进行处理。 

其次，括号的一个作用就是定义子模式，子模式关心的是匹配整体中的一部分，子模式和正则表达式的一些使用方法相联系，正式本节的主体。

与子模式相关的函数有 String.prototype.match, String.prototype.replace等，下面针对replace方法来举个栗子。

~~~js

//将字符串中的字符 &、<、>、" （双引号）, 以及 ' （单引号）转换为它们对应的 HTML 实体。
function convert(str) {
  var converter = {"&":"&amp;", "<":"&lt;", ">":"&gt;", '"':"&quot;", "'":"&apos;" };
  str = str.replace(/[(&)(<)(>)(")(')]/g,function(match){
	 return converter[match];
  });
  return str;
}
~~~

String.prototype.replace第二个参数可以为一个方法，可接收一个参数，就是前面正则表达式的子模式匹配的结果。是不是很方便。

#### 正则断言(正负零宽断言)(位置匹配)

JavaScript中有正负向零宽断言，但是之后正负预测先行，没有正负回顾后发。

* 正向预测先行: 匹配与给出的表达式匹配的位置之前的值。如: 只匹配百分号前面的数:
<pre>/\d+(?=%)/</pre>
正向预测先行的执行顺序是先从要匹配的字符串中的最右端找到第一个表达式(%),然后 再匹配其前面的表达式(\d+);

* 负向预测先行: 匹配与给出的表达式不匹配的位置之前的值。
<pre>/\d+(?!%)/</pre>
执行顺序是先从要匹配的字符串中的最右端找到第一个表达式(%),若匹配，则不取这个位置，若不匹配，则去这个位置,如果匹配了这个位置，则再去匹配其前面的表达式(\d+);

* 正向回顾后发: 匹配与给出的表达式匹配的位置之后的值。只匹配\$字符之后的值。
<pre>/(?<=\$)\d+/.exec('cost $500')</pre>
先从要匹配的字符串中的最左端找到第一个表达式(\$),匹配，则从此位置开始，向后匹配后面的表达式(\d+);

* 负向回顾后发: 匹配与给出的表达式不匹配的位置之后的值。只不匹配\$字符之后的值。
<pre>/(?<!\$)\d+/.exec('cost $500')</pre>
先从要匹配的字符串中的最左端找到第一个表达式(\$),若匹配，此次匹配失败，若不匹配，则从此位置开始，向后匹配后面的表达式(\d+);

题: 使用正则表达式匹配去掉.min.js而只匹配.js

如何是使用回馈后发的话，当然就没得问题了。不允许.js前面有.min即可，如下

~~~JavaScript
	/(?<!\.min)\.js$/.test('dscbdsc.js')
	//之后没有这个前面的.min, 才去匹配后面的.js
~~~

但就不能用预测先行了吗，并非，咱们这么说说得通。 只匹配字符串的结尾不是\.min\.js的字符串的后面的\.js, 说得通，从有往左找，找到字符串开始(验证)，如果验证成功, 再从左往右匹配。如下:

~~~JavaScript
	/^(?!.+\.min\.js$).+\.js$/.test('dscbdsc.js')
~~~

## 总结

好了，关于JavaScript中正则表达式的小小的拓展或总结，今天就到这了，算是一些小技巧或者说易网的知识点，罗列的不多，就两个，但可能需要会儿理解。其实，不得不说，正则表达式在字符串的处理方面，绝对是朵"奇葩"，啦啦啦！


## 参考，正则基础

#### 转译字符

字符 | 匹配
---- | ---
\o | NUL字符
\t |  制表符
\n | 换行符
\v |  垂直制表符
\f | 换页符
\r |  回车符
\xnn | 有16进制数nn指定的拉丁字符
\uxxxx |  有16进制数xxxx指定的Unicode字符
\cX |  控制字符^X

#### 正则表达式中的字符类

字符 | 匹配
---- | ---
[...] | 方括号类的任意字符
[^...] |  不在方括号内的任意字符
. | 除换行符和其他Unicode行终止符之外的任意字符
\w |  等价于[a-zA-Z0-9]
\W | 等价于[^a-zA-Z0-9]
\s |  任何Unicode空白符
\S | 任何非Unicode空白符
\d |  [0-9]
\D | [^0-9]
[\b] | 退格直接量

#### 重复

字符 | 匹配
---- | ---
{n,m} | 至少n次，但不超过m次
{n, } | n次或更多次
{n} | 匹配n次
? | 0次或多次
+ | 1次或多次
* | 0次或多次






———Lance Lou 2017.02